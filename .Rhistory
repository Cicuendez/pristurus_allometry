setwd("C:/DeanData/manuscripts/Submitted/2022-PristurusAllometry/pristurus_allometry")
setwd("C:/DeanData/manuscripts/Submitted/2022-PristurusAllometry/pristurus_allometry")
library(knitr)
library(kableExtra)
library(RRPP)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
# 0: Data Prep
data0 <- read.table('Analyses/data/morpho/morpho_pristurus.csv', sep = ';', dec = '.',
header = TRUE, stringsAsFactors = TRUE)
sp.to.keep <- names(which(table(data0$species) >= 5))
data <- data0[data0$species %in% sp.to.keep, ]
data$species <- droplevels(data$species)
data$SVL <- log(data$SVL)
shape <- as.matrix(log(data[, 8:ncol(data)]))
rdf <- rrpp.data.frame(svl = data$SVL, shape = shape, habitat = data$habitat_broad,
species = data$species)
# 2: Comparison of multivariate allometry among habitat types
fit.hab <- lm.rrpp(shape~svl*habitat, data = rdf)
fit.coef <- fit.hab$LM$coefficients
fit.coef[2,]
fit.coef[2,]+fit.coef[5,]
fit.coef[2,]+fit.coef[6,]
coef.hab <- cbind(fit.coef[2,], #ground
fit.coef[2,]+fit.coef[5,], #rock
fit.coef[2,]+fit.coef[6,]) #tree
coef.hab
