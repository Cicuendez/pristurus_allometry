3630*10
3630*11
library(geomorph)
?plotspec
.9^2
9500/47000000
117000/330000000
(117000/330000000)/(9500/47000000)
32*31/2
library(geomorph)
?gpagen
coords.subset
?split
?cbind
library(geomorph)
?pairwise
library(geomorph)
?trajectory.analysis
x <- matrix(1,nrow=10,ncol=3)
x
y <- matrix(4,nrow=9,ncol=3)
y
x[2:10]+y
library(geomorph)
?ordinate
gm.prcomp
?geomorph:::gm.prcomop
?geomorph:::gm.prcomp
gm.prcomp
geomorph:::gm.prcomp
geomorph:::plot.gm.prcomp
geomorph:::phylo.par
?pairwise
?geomorph:::plot.gm.prcomp
geomorph:::plot.gm.prcomp
devtools::install_github('geomorphR/geomorph', ref = "Develop")
library(geomorph)
?gm.prcomp
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
###  Traditional PCA
PCA <- gm.prcomp(Y.gpa$coords)
summary(PCA)
plot(PCA, main = "PCA")
plot(PCA,axes = F)
plot(PCA,axes = FALSE)
plot(PCA,add.abline =  FALSE)
plot(PCA,add.abline =  FALSE)
plot.gm.prcomp
geomorph:::plot.gm.prcomp
plot(PCA,add.abline =  F)
plot(PCA,add.abline =  TRUE)
plot(PCA)
devtools::install_github('geomorphR/geomorph', ref="Develop")
library(geomorph)
?plot.gm.prcomp
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)
PCA <- gm.prcomp(Y.gpa$coords)
summary(PCA)
plot(PCA, main = "PCA")
plot(PCA, add.abline = FALSE)
PCA.w.phylo <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
summary(PCA.w.phylo)
plot(PCA.w.phylo, phylo = TRUE, main = "PCA.w.phylo")
plot(PCA.w.phylo, add.abline = FALSE)
library(RRPP)
?ordinate
data("PlethMorph")
Y <- as.data.frame(PlethMorph[c("TailLength", "HeadLength",
"Snout.eye", "BodyWidth",
"Forelimb", "Hindlimb")])
Y <- as.matrix(Y)
R <- lm.rrpp(Y ~ SVL, data = PlethMorph,
iter = 0, print.progress = FALSE)$LM$residuals
PCA.ols <- ordinate(R, scale. = TRUE)
PCA.gls <- ordinate(R, scale. = TRUE,
transform. = FALSE,
Cov = PlethMorph$PhyCov)
plot(PCA.ols)
plot(PCA.ols, axes = FALSE)
plot(PCA.gls)
plot(PCA.gls, axes = FALSE)
?plot.ordinate
RRPP:::plot.ordinate
?geomorph:::plot.gm.prcomp
plot(PCA.gls, phylo = TRUE)
geomorph:::plot.gm.prcomp
geomorph:::add.tree
RRPP:::add.tree
add.tree(PlethMorph$tree)
plot(PCA.gls, axes = FALSE)
add.tree(PlethMorph$tree)
plot(PCA.gls)
add.tree(PlethMorph$tree)
class(PCA.ols)
class(PCA.gls)
plot(PCA.gls)
add.tree(PlethMorph$tree)
new <- plot(PCA.gls)
add.tree(PlethMorph$tree)
new <- plot(PCA.gls)
add.tree(PlethMorph$tree)
?add.tree
add.tree(new,PlethMorph$tree)
new <- plot(PCA.gls, axes = FALSE)
add.tree(new,PlethMorph$tree)
devtools::install_packages('mlcollyer/RRPP', ref="develop")
devtools::install_github('mlcollyer/RRPP', ref="develop")
library(geomorph)
data("PlethMorph")
Y <- as.data.frame(PlethMorph[c("TailLength", "HeadLength",
"Snout.eye", "BodyWidth",
"Forelimb", "Hindlimb")])
Y <- as.matrix(Y)
R <- lm.rrpp(Y ~ SVL, data = PlethMorph,
iter = 0, print.progress = FALSE)$LM$residuals
PCA.ols <- ordinate(R, scale. = TRUE)
PCA.gls <- ordinate(R, scale. = TRUE,
transform. = FALSE,
Cov = PlethMorph$PhyCov)
plot(PCA.ols)
plot(PCA.ols, axes = FALSE)
plot(PCA.gls)
plot(PCA.gls, axes = FALSE)
?plot.ordinate
plot(PCA.ols, include.axes = FALSE)
?prcomp
?gm.prcomp
### geomorph
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
PCA <- gm.prcomp(Y.gpa$coords)
pPCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
plot(PCA, main = "PCA", phylo = TRUE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
phylo.PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, GLS = TRUE)
PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
phylo.PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, GLS = TRUE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
plot(phylo.PCA, phylo = TRUE, main = "phylo PCA")
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo", include.axes = FALSE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo", include.axes = FALSE)
plot(phylo.PCA, phylo = TRUE, main = "phylo PCA", include.axes = FALSE)
?RRPP:::plot.ordinate
devtools::install_github('geomorphR/geomorph', ref="Develop")
install.packages('Rcpp')
install.packages('tibble')
install.packages(c("broom", "bslib", "callr", "caret", "castor", "cubature", "dbplyr", "deSolve", "devtools", "dplyr", "dtplyr", "fontawesome", "forcats", "future", "future.apply", "generics", "gert", "ggforce", "ggraph", "globals", "gmp", "googlesheets4", "graphlayouts", "gtools", "hardhat", "haven", "hms", "httr", "hunspell", "igraph", "interp", "latticeExtra", "lme4", "lobstr", "MCMCglmm", "meta", "metafor", "modelr", "ncbit", "paleotree", "parallelly", "phytools", "pkgload", "processx", "progressr", "quantreg", "R.cache", "R.utils", "raster", "RcppArmadillo", "RCurl", "readxl", "recipes", "reprex", "rhub", "rlang", "rmarkdown", "roxygen2", "RSQLite", "rstudioapi", "rversions", "rvest", "s2", "sass", "scholar", "sf", "shiny", "shinyWidgets", "spam", "spData", "spdep", "statmod", "terra", "tidygraph", "tidyverse", "timeDate", "tinytex", "tweenr"))
library(geomorph)
data("pupfish")
Pupfish$CS
data("Pupfish")
gp <- intersect(Pupfish$Pop,Pupfish$Sex)
gp
?lm.rrpp
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
gp
fit <- lm.rrpp(Pupfish$CS~gp)
fit <- lm.rrpp(Pupfish$CS~gp, iter = 4999)
anova(fit)
fit$PermInfo$perms
fit$ANOVA$Fs
plot(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs)
density(fit$ANOVA$Fs)
plot(density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 20)
hist(fit$ANOVA$Fs, breaks = 40)
hist(fit$ANOVA$Fs, breaks = 60)
hist(fit$ANOVA$Fs, breaks = 80)
density(fit$ANOVA$Fs)
curve(density(fit$ANOVA$Fs))
lines(density(fit$ANOVA$Fs))
?density
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
?ks
?ks.test
ks.test(fit$ANOVA$Fs,"F")
ks.test(fit$ANOVA$Fs,"pnorm")
anova(fit)
fit$ANOVA$\
fit$ANOVA$df
fit$ANOVA$df[1]
ks.test(fit$ANOVA$Fs,pf(fit$ANOVA$df[1],fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,pf(df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,df(df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
df(fit$ANOVA$Fs,3,50)
df(4999,3,50)
rf(4999,3,50)
hist(rf(4999,3,50))
density(rf(4999,3,50))
plot(density(rf(4999,3,50)))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
anova(fit)
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
library(geomorph)
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
anova(fit)
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
hist(fit$ANOVA$Fs, breaks = 80)
points(density(fit$ANOVA$Fs))
points(fit$ANOVA$Fs,density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs), col = 4, lwd = 2)
hist(fit$ANOVA$Fs, breaks = 80, ylim = c(0, max(fit$ANOVA$Fs)))
hist(fit$ANOVA$Fs, breaks = 80, xlim = c(0, max(fit$ANOVA$Fs)))
lines(density(fit$ANOVA$Fs), col = 4, lwd = 2)
X <- fit$ANOVA$Fs
X <- fit$ANOVA$Fs
hist(x, breaks = 80)
x <- fit$ANOVA$Fs
hist(x, breaks = 80)
seq(min(x), max(x), length = 40)
seq(min(x), max(x), length = 80)
lines(seq(min(x), max(x), length = 80),density(fit$ANOVA$Fs), col = 4, lwd = 2)
hist(x, breaks = 80)
lines(density(x), col = 4, lwd = 2)
plot(density(x))
hist(x, breaks = 80,freq = T)
hist(x, breaks = 80,freq = F)
lines(density(x), col = 4, lwd = 2)
lines(density(x), col = "red", lwd = 2)
levels(gp)
nlevels(gp)
Pupfish$CS
length(Pupfish$CS)
length(Pupfish$CS)-nlevels(gp)
df.theory <- df(density(Pupfish$CS, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
)
df.theory <- df(density(Pupfish$CS), nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
density(Pupfish$CS)$x
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
df.theory
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(Pupfish$CS)
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(Pupfish$CS)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
points(df.ols.ols[[1]]$x,df.theory, col = "red", lwd = 2)
points(obs$x,df.theory, col = "red", lwd = 2)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
points(obs$x,df.theory, col = "red", lwd = 2)
lines(obs$x,df.theory, col = "red", lwd = 2)
obs
obs$x
df.theory
df.theory <- df(density(fit$ANOVA$Fs)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
fit$ANOVA$df
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
library(geomorph)
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x)
)
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x,df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
length(fit$ANOVA$Fs)
length(df(density(fit$ANOVA$Fs)$x)
)
#not working. Figure it out
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#I think this is correct
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
?lm.rrpp
?RRPP::lm.rrpp
library(RRPP)
?lm.rrpp
devtools::install_githbub('mlcollyer/RRPP', ref="develop", build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', ref="develop", build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP')
install.packages(c("cli", "lifecycle"))
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
library(nlme)
?gls
x = rnorm(100, mean = 10, sd = 2)
y = rnorm(100, mean = 20, sd = 2)
bimodal =c(x,y)
shapiro.test(bimodal)
hist(bimodal)
Transformation with Box-Cox
library(geoR)
lambda=boxcoxfit(bimodal)$lambda
bin.tr.bc=((bimodal^lambda)-1)/(lambda)
shapiro.test(bin.tr.bc)
install.packages("geoR")
library(geoR)
lambda=boxcoxfit(bimodal)$lambda
bin.tr.bc=((bimodal^lambda)-1)/(lambda)
shapiro.test(bin.tr.bc)
hist(bin.tr.bc)
Log
shapiro.test(log(bimodal))
hist(log(bimodal))
Square root
shapiro.test(sqrt(bimodal))
hist(sqrt(bimodal))
shapiro.test((log(bimodal))^2)
hist((log(bimodal))^2)
log exponent 1.5
shapiro.test((log(bimodal))^1.5)
hist((log(bimodal))^1.5)
shapiro.test((bimodal)^(1/3))
hist((bimodal)^(1/3))
shapiro.test(asin((bimodal/max(bimodal))^(1/2)))
hist(asin((bimodal/max(bimodal))^(1/2)))
transformed <- abs(binomial - mean(binomial))
transformed <- abs(bimodal - mean(bimodal))
shapiro.test(transformed)
hist(transformed)
data:  transformed
library(geomorph)
?gm.prcomp
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
###  Traditional PCA
PCA <- gm.prcomp(Y.gpa$coords)
PCA$shapes
library(geomorph)
?plotAllometry
data("larvalMorph")
Y.gpa <- gpagen(larvalMorph$tailcoords, curves = larvalMorph$tail.sliders,
ProcD = FALSE, print.progress = FALSE)
gdf <- geomorph.data.frame(Y.gpa, treatment = larvalMorph$treatment,
family = larvalMorph$family)
fit1 <- procD.lm(coords ~ Csize,
data = gdf, print.progress = FALSE) # simple allometry model
a <- plotAllometry(fit1, size = gdf$Csize, logsz = F, method = "RegScore")
a1 <- a$RegScore
b <- plotAllometry(fit1, size = gdf$Csize, logsz = T, method = "RegScore")
b1 <- b$RegScore
fit2 <- procD.lm(coords ~ log(Csize), data = gdf, print.progress = FALSE)
c <- plotAllometry(fit2, size = gdf$Csize, logsz = F, method = "RegScore")
c1 <- c$RegScore
d <- plotAllometry(fit2, size = gdf$Csize, logsz = T, method = "RegScore")
d1 <- d$RegScore
setwd("C:/DeanData/manuscripts/Submitted/2022-PristurusAllometry/pristurus_allometry/Analyses")
libs <- c('geomorph', 'RRPP', 'phytools', 'geiger', 'tidyverse')
easypackages::libraries(libs)
# 0: Data Prep
data0 <- read.table('data/morpho/morpho_pristurus.csv', sep = ';', dec = '.', header = TRUE, stringsAsFactors = TRUE)
sp.to.keep <- names(which(table(data0$species) >= 5))
data <- data0[data0$species %in% sp.to.keep, ]
data$species <- droplevels(data$species)
data$SVL <- log(data$SVL)
shape <- as.matrix(log(data[, 8:ncol(data)]))
rdf <- rrpp.data.frame(svl = data$SVL, shape = shape, habitat = data$habitat_broad, species = data$species)
tree0 <- read.nexus('data/phylogeny/pristurus_tree_final.nex')
LS.mns <- pairwise(lm.rrpp(shape~species, data = rdf, iter=0), groups = rdf$species)$LS.means[[1]]
sz.mn <- tapply(rdf$svl,rdf$species,mean)
hab.mn <- as.factor(by(rdf$habitat,rdf$species,unique))
levels(hab.mn) <- levels(rdf$habitat)
tree <- treedata(phy = tree0, data = LS.mns)$phy
C <- vcv.phylo(tree)
# 1: Evolutionary Allometry
allom.sp <- lm.rrpp(LS.mns~sz.mn, Cov = C)
allom.ind <- lm.rrpp(shape~svl, data = rdf)
anova(allom.sp)
anova(allom.ind)
M <-rbind(coef.sp <- allom.sp$LM$gls.coefficients[2,],
coef.ind <- allom.ind$LM$coefficients[2,])
acos(RRPP:::vec.cor.matrix(M))*180/pi  #virtually parallel (angle of 1.49 degrees)
# 2: Comparison of multivariate allometry among habitat types
fit.hab <- lm.rrpp(shape~svl*habitat, data = rdf)
anova(fit.hab)
pw.hab <- pairwise(fit.hab, groups = rdf$habitat, covariate = rdf$svl)
summary(pw.hab, type = 'VC', stat.table = FALSE)
#Slopes by habitat
fit.coef <- fit.hab$LM$coefficients
ind.coef <- rbind(fit.coef[2,], fit.coef[2,]+fit.coef[5,], fit.coef[2,]+fit.coef[6,])
rownames(ind.coef) <- c("Ground","Rock", "Tree")
ind.coef
# 3: Map allometry slopes on phylogeny
head.scores <- two.b.pls(shape[, c(2:4)], rdf$svl)$XScores[, 1]
limb.scores <- two.b.pls(shape[, 5:8], rdf$svl)$XScores[, 1]
coef.head <- lm.rrpp(head.scores ~ rdf$svl*rdf$species)$LM$coefficients
coef.limb <- lm.rrpp(limb.scores ~ rdf$svl*rdf$species)$LM$coefficients
head.slp <- coef.head[grep('svl', rownames(coef.head)), ]
head.slp[-1] <- head.slp[-1] + head.slp[1]
limb.slp <- coef.limb[grep('svl', rownames(coef.limb)), ]
limb.slp[-1] <- limb.slp[-1] + limb.slp[1]
names(limb.slp) <- names(head.slp) <- levels(rdf$species)
cor(head.slp,limb.slp)
plot(head.slp,limb.slp)
contMap(tree = tree, x = head.slp, outline = FALSE)
cm.limb <- contMap(tree = tree, x = limb.slp, outline = FALSE)
# 4: phylomorphospace of size-standardized data (residuals)
shape.res <- residuals(allom.sp)
pca.w.phylo <- gm.prcomp(shape.res, phy = tree)
plot(pca.w.phylo, phylo = TRUE, pch = 21, bg = 'black', phylo.par = list(node.labels = FALSE))
################################ NEW HERE
# 5: Compare Integration
lindims.gp <- lapply( split( shape[,1:ncol(shape)], rdf$habitat), matrix, ncol=ncol(shape))
Vrel.gp <- Map(function(x) integration.Vrel(x), lindims.gp)
out <- compare.ZVrel(Vrel.gp$ground, Vrel.gp$rock, Vrel.gp$tree)
summary(out)
c(Vrel.gp$ground$ZR,Vrel.gp$rock$ZR,Vrel.gp$tree$ZR)
c(Vrel.gp$ground$ZR,Vrel.gp$rock$ZR,Vrel.gp$tree$ZR)
summary(out)
