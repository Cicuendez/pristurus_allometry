shape$points.var
n <-dim(plethodon$land)[3]
p <- manders$p; k <- manders$k
data(plethodon)
manders <- gpagen(plethodon$land)
mn <- mshape(manders$coords)
n <-dim(plethodon$land)[3]
p <- manders$p; k <- manders$k
n
p
k
library(geomorph)
data(plethodon)
manders <- gpagen(plethodon$land)
mn <- mshape(manders$coords)
n <-dim(plethodon$land)[3]
p <- manders$p; k <- manders$k
var.obs <- mean(diag(var(two.d.array(manders$coords))))
library(MASS)
sim.1 <- arrayspecs(mvrnorm(n,mu=matrix(t(mn.Fix)),Sigma=diag(1,p*k)),p=p,k=k)
sim.1 <- arrayspecs(mvrnorm(n,mu=matrix(t(mn)),Sigma=diag(1,p*k)),p=p,k=k)
sim.2 <- arrayspecs(mvrnorm(n,mu=matrix(t(mn)),Sigma=diag(var.in.Fix,p*k)),p=p,k=k
plotAllSpecimens(sim.1)
sim.2 <- arrayspecs(mvrnorm(n,mu=matrix(t(mn)),Sigma=diag(var.in.Fix,p*k)),p=p,k=k)
sim.2 <- arrayspecs(mvrnorm(n,mu=matrix(t(mn)),Sigma=diag(var.obs,p*k)),p=p,k=k)
plotAllSpecimens(sim.1)
plotAllSpecimens(sim.2)
?geomorph:::procD.lm
library(geomorph)
integration.test
library(geomorph)
data("scallops")
Y <- gpagen(scallops$coorddata)
pca <- gm.prcomp(Y$coords)
plot(pca)
library(geomorph)
?estimate.missing
estimate.missing
data(plethodon)
plethland<-plethodon$land
dim(plethland)
sample(1:40,1)
dim(plethland)
data(plethodon)
plethland<-plethodon$land
new <- plethland
for i in 1:40{
for (i in 1:40){
miss <- sample(1:12,1)
new[miss,,i] <- NA
}
miss
ndew
new
estimate.missing(new,method="TPS")
estimate.missing(new,method="Reg")
dim(new)
75*80
library(geomorph)
?compare.ZVrel
RRPP::pairwise
?RRPP::pairwise
library(geomorph)
data("plethodon")
Y.gpa <- gpagen(plethodon$land)    #GPA-alignment
fit.full <- procD.lm(coords ~ log(Csize) + species * site, data = gdf,
iter = 999, print.progress = FALSE, turbo = TRUE) #allometry model
fit.full <- procD.lm(coords ~ log(Csize) + species * site, data = gdf,iter = 999, print.progress = FALSE, turbo = TRUE) #allometry model
3630*10
3630*11
library(geomorph)
?plotspec
.9^2
9500/47000000
117000/330000000
(117000/330000000)/(9500/47000000)
32*31/2
library(geomorph)
?gpagen
coords.subset
?split
?cbind
library(geomorph)
?pairwise
library(geomorph)
?trajectory.analysis
x <- matrix(1,nrow=10,ncol=3)
x
y <- matrix(4,nrow=9,ncol=3)
y
x[2:10]+y
library(geomorph)
?ordinate
gm.prcomp
?geomorph:::gm.prcomop
?geomorph:::gm.prcomp
gm.prcomp
geomorph:::gm.prcomp
geomorph:::plot.gm.prcomp
geomorph:::phylo.par
?pairwise
?geomorph:::plot.gm.prcomp
geomorph:::plot.gm.prcomp
devtools::install_github('geomorphR/geomorph', ref = "Develop")
library(geomorph)
?gm.prcomp
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
###  Traditional PCA
PCA <- gm.prcomp(Y.gpa$coords)
summary(PCA)
plot(PCA, main = "PCA")
plot(PCA,axes = F)
plot(PCA,axes = FALSE)
plot(PCA,add.abline =  FALSE)
plot(PCA,add.abline =  FALSE)
plot.gm.prcomp
geomorph:::plot.gm.prcomp
plot(PCA,add.abline =  F)
plot(PCA,add.abline =  TRUE)
plot(PCA)
devtools::install_github('geomorphR/geomorph', ref="Develop")
library(geomorph)
?plot.gm.prcomp
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)
PCA <- gm.prcomp(Y.gpa$coords)
summary(PCA)
plot(PCA, main = "PCA")
plot(PCA, add.abline = FALSE)
PCA.w.phylo <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
summary(PCA.w.phylo)
plot(PCA.w.phylo, phylo = TRUE, main = "PCA.w.phylo")
plot(PCA.w.phylo, add.abline = FALSE)
library(RRPP)
?ordinate
data("PlethMorph")
Y <- as.data.frame(PlethMorph[c("TailLength", "HeadLength",
"Snout.eye", "BodyWidth",
"Forelimb", "Hindlimb")])
Y <- as.matrix(Y)
R <- lm.rrpp(Y ~ SVL, data = PlethMorph,
iter = 0, print.progress = FALSE)$LM$residuals
PCA.ols <- ordinate(R, scale. = TRUE)
PCA.gls <- ordinate(R, scale. = TRUE,
transform. = FALSE,
Cov = PlethMorph$PhyCov)
plot(PCA.ols)
plot(PCA.ols, axes = FALSE)
plot(PCA.gls)
plot(PCA.gls, axes = FALSE)
?plot.ordinate
RRPP:::plot.ordinate
?geomorph:::plot.gm.prcomp
plot(PCA.gls, phylo = TRUE)
geomorph:::plot.gm.prcomp
geomorph:::add.tree
RRPP:::add.tree
add.tree(PlethMorph$tree)
plot(PCA.gls, axes = FALSE)
add.tree(PlethMorph$tree)
plot(PCA.gls)
add.tree(PlethMorph$tree)
class(PCA.ols)
class(PCA.gls)
plot(PCA.gls)
add.tree(PlethMorph$tree)
new <- plot(PCA.gls)
add.tree(PlethMorph$tree)
new <- plot(PCA.gls)
add.tree(PlethMorph$tree)
?add.tree
add.tree(new,PlethMorph$tree)
new <- plot(PCA.gls, axes = FALSE)
add.tree(new,PlethMorph$tree)
devtools::install_packages('mlcollyer/RRPP', ref="develop")
devtools::install_github('mlcollyer/RRPP', ref="develop")
library(geomorph)
data("PlethMorph")
Y <- as.data.frame(PlethMorph[c("TailLength", "HeadLength",
"Snout.eye", "BodyWidth",
"Forelimb", "Hindlimb")])
Y <- as.matrix(Y)
R <- lm.rrpp(Y ~ SVL, data = PlethMorph,
iter = 0, print.progress = FALSE)$LM$residuals
PCA.ols <- ordinate(R, scale. = TRUE)
PCA.gls <- ordinate(R, scale. = TRUE,
transform. = FALSE,
Cov = PlethMorph$PhyCov)
plot(PCA.ols)
plot(PCA.ols, axes = FALSE)
plot(PCA.gls)
plot(PCA.gls, axes = FALSE)
?plot.ordinate
plot(PCA.ols, include.axes = FALSE)
?prcomp
?gm.prcomp
### geomorph
data(plethspecies)
Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
PCA <- gm.prcomp(Y.gpa$coords)
pPCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
plot(PCA, main = "PCA", phylo = TRUE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
phylo.PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, GLS = TRUE)
PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
phylo.PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, GLS = TRUE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
plot(phylo.PCA, phylo = TRUE, main = "phylo PCA")
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo", include.axes = FALSE)
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo")
plot(pPCA, phylo = TRUE, main = "PCA.w.phylo", include.axes = FALSE)
plot(phylo.PCA, phylo = TRUE, main = "phylo PCA", include.axes = FALSE)
?RRPP:::plot.ordinate
devtools::install_github('geomorphR/geomorph', ref="Develop")
install.packages('Rcpp')
install.packages('tibble')
install.packages(c("broom", "bslib", "callr", "caret", "castor", "cubature", "dbplyr", "deSolve", "devtools", "dplyr", "dtplyr", "fontawesome", "forcats", "future", "future.apply", "generics", "gert", "ggforce", "ggraph", "globals", "gmp", "googlesheets4", "graphlayouts", "gtools", "hardhat", "haven", "hms", "httr", "hunspell", "igraph", "interp", "latticeExtra", "lme4", "lobstr", "MCMCglmm", "meta", "metafor", "modelr", "ncbit", "paleotree", "parallelly", "phytools", "pkgload", "processx", "progressr", "quantreg", "R.cache", "R.utils", "raster", "RcppArmadillo", "RCurl", "readxl", "recipes", "reprex", "rhub", "rlang", "rmarkdown", "roxygen2", "RSQLite", "rstudioapi", "rversions", "rvest", "s2", "sass", "scholar", "sf", "shiny", "shinyWidgets", "spam", "spData", "spdep", "statmod", "terra", "tidygraph", "tidyverse", "timeDate", "tinytex", "tweenr"))
library(geomorph)
data("pupfish")
Pupfish$CS
data("Pupfish")
gp <- intersect(Pupfish$Pop,Pupfish$Sex)
gp
?lm.rrpp
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
gp
fit <- lm.rrpp(Pupfish$CS~gp)
fit <- lm.rrpp(Pupfish$CS~gp, iter = 4999)
anova(fit)
fit$PermInfo$perms
fit$ANOVA$Fs
plot(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs)
density(fit$ANOVA$Fs)
plot(density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 20)
hist(fit$ANOVA$Fs, breaks = 40)
hist(fit$ANOVA$Fs, breaks = 60)
hist(fit$ANOVA$Fs, breaks = 80)
density(fit$ANOVA$Fs)
curve(density(fit$ANOVA$Fs))
lines(density(fit$ANOVA$Fs))
?density
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
?ks
?ks.test
ks.test(fit$ANOVA$Fs,"F")
ks.test(fit$ANOVA$Fs,"pnorm")
anova(fit)
fit$ANOVA$\
fit$ANOVA$df
fit$ANOVA$df[1]
ks.test(fit$ANOVA$Fs,pf(fit$ANOVA$df[1],fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,pf(df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,df(df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
df(fit$ANOVA$Fs,3,50)
df(4999,3,50)
rf(4999,3,50)
hist(rf(4999,3,50))
density(rf(4999,3,50))
plot(density(rf(4999,3,50)))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
anova(fit)
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
library(geomorph)
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
anova(fit)
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
plot(density(fit$ANOVA$Fs))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
hist(fit$ANOVA$Fs, breaks = 80)
points(density(fit$ANOVA$Fs))
points(fit$ANOVA$Fs,density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs))
hist(fit$ANOVA$Fs, breaks = 80)
lines(density(fit$ANOVA$Fs), col = 4, lwd = 2)
hist(fit$ANOVA$Fs, breaks = 80, ylim = c(0, max(fit$ANOVA$Fs)))
hist(fit$ANOVA$Fs, breaks = 80, xlim = c(0, max(fit$ANOVA$Fs)))
lines(density(fit$ANOVA$Fs), col = 4, lwd = 2)
X <- fit$ANOVA$Fs
X <- fit$ANOVA$Fs
hist(x, breaks = 80)
x <- fit$ANOVA$Fs
hist(x, breaks = 80)
seq(min(x), max(x), length = 40)
seq(min(x), max(x), length = 80)
lines(seq(min(x), max(x), length = 80),density(fit$ANOVA$Fs), col = 4, lwd = 2)
hist(x, breaks = 80)
lines(density(x), col = 4, lwd = 2)
plot(density(x))
hist(x, breaks = 80,freq = T)
hist(x, breaks = 80,freq = F)
lines(density(x), col = 4, lwd = 2)
lines(density(x), col = "red", lwd = 2)
levels(gp)
nlevels(gp)
Pupfish$CS
length(Pupfish$CS)
length(Pupfish$CS)-nlevels(gp)
df.theory <- df(density(Pupfish$CS, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
)
df.theory <- df(density(Pupfish$CS), nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
density(Pupfish$CS)$x
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
df.theory
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(Pupfish$CS)
df.theory <- df(density(Pupfish$CS)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(Pupfish$CS)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
points(df.ols.ols[[1]]$x,df.theory, col = "red", lwd = 2)
points(obs$x,df.theory, col = "red", lwd = 2)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
points(obs$x,df.theory, col = "red", lwd = 2)
lines(obs$x,df.theory, col = "red", lwd = 2)
obs
obs$x
df.theory
df.theory <- df(density(fit$ANOVA$Fs)$x, nlevels(gp)-1, length(Pupfish$CS)-nlevels(gp))
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
fit$ANOVA$df
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
library(geomorph)
data("Pupfish")
gp <- interaction(Pupfish$Pop,Pupfish$Sex)
iter=4999
fit <- lm.rrpp(Pupfish$CS~gp, iter = iter)
df.theory <- df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2])
obs <- density(fit$ANOVA$Fs)
hist(fit$ANOVA$Fs, breaks = 80,freq = F)
lines(obs$x,df.theory, col = "red", lwd = 2)
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x)
)
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x,df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
length(fit$ANOVA$Fs)
length(df(density(fit$ANOVA$Fs)$x)
)
#not working. Figure it out
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,df(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#I think this is correct
ks.test(fit$ANOVA$Fs,rf((iter+1),df1=fit$ANOVA$df[1],df2=fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
#not working. Figure it out
ks.test(fit$ANOVA$Fs,rf(density(fit$ANOVA$Fs)$x, fit$ANOVA$df[1], fit$ANOVA$df[2]))
?lm.rrpp
?RRPP::lm.rrpp
library(RRPP)
?lm.rrpp
devtools::install_githbub('mlcollyer/RRPP', ref="develop", build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', ref="develop", build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
devtools::install_github('mlcollyer/RRPP')
install.packages(c("cli", "lifecycle"))
devtools::install_github('mlcollyer/RRPP', build_vignettes = TRUE)
library(nlme)
?gls
setwd("C:/DeanData/manuscripts/Submitted/2022-PristurusAllometry/pristurus_allometry/Analyses")
# Packages ----
libs <- c('geomorph', 'RRPP', 'phytools', 'geiger', 'tidyverse',
'ggphylomorpho')
easypackages::libraries(libs)
# Morpho data ----
# Both species data and specimen data
data.sp <- read.table('data/morpho/morpho_sp_final.csv', sep = ';',
dec = '.', header = TRUE)
data0 <- read.table('data/morpho/morpho_pristurus.csv', sep = ';',
dec = '.', header = TRUE)
# Drop species with less than 5 individuals
sp.to.keep <- names(which(table(data0$species) >= 5))
data <- data0[data0$species %in% sp.to.keep, ]
# number of species, specimens, and specimens per species
n.sp <- length(which(table(data$species) >= 5)) # number of species
nrow(data) # number of specimens
mean(table(data$species)[table(data$species) >= 5])
min(table(data$species)[table(data$species) >= 5])
max(table(data$species)[table(data$species) >= 5])
# Phylogeny ----
tree0 <- read.nexus('data/phylogeny/pristurus_tree_final.nex')
# Prepare specimen data for analysis ----
svl <- log(data$SVL)
shape <- as.matrix(log(data[, 8:ncol(data)]))
species.fctr <- as.factor(data$species)
habitat.fctr <- as.factor(data$habitat_broad)
rdf <- rrpp.data.frame(svl = svl, shape = shape, habitat = habitat.fctr,
species = species.fctr)
# Habitat model ----
# Get slopes per habitat
# Multivariate linear model
fit.hab <- lm.rrpp(shape~svl*habitat, data = rdf)
anova(fit.hab)
##### regression coefficients
fit.coef <- fit.hab$LM$coefficients
rbind(fit.coef[1,], fit.coef[2,]) #ground
rbind(fit.coef[1,]+fit.coef[3,], fit.coef[2,]+fit.coef[5,]) #rock
rbind(fit.coef[1,]+fit.coef[4,], fit.coef[2,]+fit.coef[6,]) #tree
# Pairwise differences in the angle ----
pw.hab <- pairwise(fit.hab, groups = rdf$habitat, covariate = rdf$svl)
pw.hab_df <- summary(pw.hab, type = 'VC', stat.table = FALSE)
pw.hab_df
dim(rdf$svl)
length(rdf$svl)
##### regression coefficients
fit.coef <- fit.hab$LM$coefficients
rbind(fit.coef[1,], fit.coef[2,]) #ground
rbind(fit.coef[1,]+fit.coef[3,], fit.coef[2,]+fit.coef[5,]) #rock
rbind(fit.coef[1,]+fit.coef[4,], fit.coef[2,]+fit.coef[6,]) #tree
# Pairwise differences in the angle ----
pw.hab <- pairwise(fit.hab, groups = rdf$habitat, covariate = rdf$svl)
pw.hab_df <- summary(pw.hab, type = 'VC', stat.table = FALSE)
pw.hab_df
# Set habitat colors ----
hab.colors <- c(ground = "#F1B670", rock = "#683B5E", tree = "#E93F7B")
