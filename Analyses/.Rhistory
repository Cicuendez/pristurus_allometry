plot.pls.head
plot(fit.head.sp, predictor = svl, type = 'regression', pch = 16,
reg.type = 'RegScore',
col = species.fctr)
limb.slp
head.slp
species.fctr
svl
head.scores
head.res
# EVOLUTIONARY ALLOMETRY head and limbs ----
# Linear Models ----
# lm(PLS.scores ~ svl*habitat)
fit.head.hab <- lm.rrpp(head.scores ~ svl*habitat.fctr)
fit.limb.hab <- lm.rrpp(limb.scores ~ svl*habitat.fctr)
hab.sp.fctr
head.res <- shape.res[, 2:4]
rdf.head.hab <- rrpp.data.frame(head = head.res, hab = hab.sp.fctr)
fit.head.hab.sp <- lm.rrpp(head~hab, data = rdf.head.hab, Cov = vcv(tree))
anova(fit.head.hab.sp)
pw.head.hab <- pairwise(fit.head.hab.sp, groups = rdf.head.hab$hab)
pw.head.hab_df <- summary(pw.head.hab, type = 'var', stat.table = FALSE)
# limb ~ habitat model ----
limb.res <- shape.res[, 5:8]
rdf.limb.hab <- rrpp.data.frame(limb = limb.res, hab = hab.sp.fctr)
fit.limb.hab.sp <- lm.rrpp(limb~hab, data = rdf.limb.hab, Cov = vcv(tree))
anova(fit.limb.hab.sp)
pw.limb.hab <- pairwise(fit.limb.hab.sp, groups = rdf.limb.hab$hab)
pw.limb.hab_df <- summary(pw.limb.hab, type = 'var', stat.table = FALSE)
hab.fctr
hab.sp
hab.sp
hab.sp <- dat.morpho.num$habitat_broad
# EVOLUTIONARY ALLOMETRY head and limbs ----
# Linear Models ----
# lm(PLS.scores ~ svl*habitat)
fit.head.hab <- lm.rrpp(head.scores ~ svl*habitat.fctr)
fit.limb.hab <- lm.rrpp(limb.scores ~ svl*habitat.fctr)
fit.head.hab$LM$coefficients
coef.ind
coef.head.hab
coef.head.hab <- fit.head.hab$LM$coefficients
coef.head.hab
slp.head.hab <- rbind(coef.head.hab[2,], coef.head.hab[2,]+coef.head.hab[5,],
coef.head.hab[2,]+coef.head.hab[6,])
slp.head.hab
rownames(slp.head.hab) <- c("ground","rock", "tree")
slp.head.hab
coef.limb.hab <- fit.limb.hab$LM$coefficients
slp.limb.hab <- rbind(coef.limb.hab[2,], coef.limb.hab[2,]+coef.limb.hab[5,],
coef.limb.hab[2,]+coef.limb.hab[6,])
rownames(slp.limb.hab) <- c("ground","rock", "tree")
slp.limb.hab
slp.head.hab
slp.limb.hab
limb.slp
slp.limb.hab
limb.slp
slp.head.hab
head.slp[hab.mn == 'ground', ]
head.slp[hab.mn == 'ground']
slp.head.comp.ground <-rbind(evol_alom = slp.head.hab['ground',],
head.slp[hab.mn == 'ground'])
vec.cor.matrix(slp.head.comp.ground)
slp.head.comp.ground
slp.head.hab['ground',]
head.slp[hab.mn == 'ground']
as.data.frame(head.slp[hab.mn == 'ground'])
as.data.frame(head.slp = head.slp[hab.mn == 'ground'])
data.frame(head.slp = head.slp[hab.mn == 'ground'])
rbind(evol_alom = slp.head.hab['ground',],
data.frame(head.slp = head.slp[hab.mn == 'ground']))
slp.head.comp.ground <-rbind(evol_alom = slp.head.hab['ground',],
data.frame(head.slp = head.slp[hab.mn == 'ground']))
slp.head.comp.ground
vec.cor.matrix(slp.head.comp.ground)
slp.head.comp.ground
x
xx
xx <- data.frame(a = c(1:5), b = 3)
xx
cor(xx)
vec.cor.matrix(slp.head.comp.ground)
slp.head.comp.ground
head.slp
cor(x = head.slp = head.slp[hab.mn == 'ground'], y = slp.head.hab['ground',])
cor(x = head.slp[hab.mn == 'ground'], y = slp.head.hab['ground',])
cor(x = head.slp[hab.mn == 'ground'],
y = rep(slp.head.hab['ground',], nrow(head.slp[hab.mn == 'ground'])))
shape.head
# EVOLUTIONARY ALLOMETRY head and limbs ----
# Linear Models ----
# lm(PLS.scores ~ svl*habitat)
fit.head.hab <- lm.rrpp(shape.head ~ svl*habitat.fctr)
coef.head.hab <- fit.head.hab$LM$coefficients
slp.head.hab <- rbind(coef.head.hab[2,], coef.head.hab[2,]+coef.head.hab[5,],
coef.head.hab[2,]+coef.head.hab[6,])
rownames(slp.head.hab) <- c("ground","rock", "tree")
slp.head.hab
fit.limb.hab <- lm.rrpp(shape.limb ~ svl*habitat.fctr)
coef.limb.hab <- fit.limb.hab$LM$coefficients
slp.limb.hab <- rbind(coef.limb.hab[2,], coef.limb.hab[2,]+coef.limb.hab[5,],
coef.limb.hab[2,]+coef.limb.hab[6,])
rownames(slp.limb.hab) <- c("ground","rock", "tree")
slp.limb.hab
# STATIC ALLOMETRY head and limbs ----
# Linear Models ----
# lm(PLS.scores ~ svl*sp)
fit.head.sp <- lm.rrpp(shape.head ~ svl*species.fctr)
plot.pls.head <- plot(fit.head.sp, predictor = svl, type = 'regression', pch = 16,
col = species.fctr)
plot.pls.head$PredLine
plot.pls.head$RegScore
fit.head.sp <- lm.rrpp(head.scores ~ svl*species.fctr)
fit.limb.sp <- lm.rrpp(limb.scores ~ svl*species.fctr)
fit.shape.sp <- lm.rrpp(shape.scores ~ svl*species.fctr)
# EVOLUTIONARY ALLOMETRY head and limbs ----
# Linear Models ----
# lm(PLS.scores ~ svl*habitat)
fit.headshape.hab <- lm.rrpp(shape.head ~ svl*habitat.fctr)
coef.headshape.hab <- fit.head.hab$LM$coefficients
slp.headshape.hab <- rbind(coef.head.hab[2,], coef.head.hab[2,]+coef.head.hab[5,],
coef.head.hab[2,]+coef.head.hab[6,])
rownames(slp.headshape.hab) <- c("ground","rock", "tree")
fit.headshape.hab <- lm.rrpp(shape.head ~ svl*habitat.fctr)
coef.headshape.hab <- fit.headshape.hab$LM$coefficients
slp.headshape.hab <- rbind(coef.headshape.hab[2,],
coef.headshape.hab[2,]+coef.headshape.hab[5,],
coef.headshape.hab[2,]+coef.headshape.hab[6,])
rownames(slp.headshape.hab) <- c("ground","rock", "tree")
slp.headshape.hab
fit.limbshape.hab <- lm.rrpp(shape.limb ~ svl*habitat.fctr)
coef.limbshape.hab <- fit.limbshape.hab$LM$coefficients
slp.limbshape.hab <- rbind(coef.limbshape.hab[2,],
coef.limbshape.hab[2,]+coef.limbshape.hab[5,],
coef.limbshape.hab[2,]+coef.limbshape.hab[6,])
rownames(slp.limbshape.hab) <- c("ground","rock", "tree")
slp.limbshape.hab
plot.headshape.fit <- plot(fit.headshape.sp, predictor = svl, type = 'regression', pch = 16,
col = species.fctr)
# STATIC ALLOMETRY head and limbs ----
# Linear Models ----
# lm(shape.vars ~ svl*sp)
fit.headshape.sp <- lm.rrpp(shape.head ~ svl*species.fctr)
plot.headshape.fit <- plot(fit.headshape.sp, predictor = svl, type = 'regression', pch = 16,
col = species.fctr)
plot.headshape.fit$PredLine
plot.headshape.fit$RegScore
plot(plot.headshape.fit, predictor = svl, type = 'regression', pch = 16,
reg.type = 'RegScore',
col = species.fctr)
plot.headshape.fit$RegScore
plot(fit.headshape.sp, predictor = svl, type = 'regression', pch = 16,
reg.type = 'RegScore',
col = species.fctr)
fit.limbshape.sp <- lm.rrpp(shape.head ~ svl*species.fctr)
plot.limbshape.fit <- plot(fit.limbshape.sp, predictor = svl, type = 'regression', pch = 16,
col = species.fctr)
plot.limbshape.fit$PredLine
plot.limbshape.fit$RegScore
plot(fit.limbshape.sp, predictor = svl, type = 'regression', pch = 16,
reg.type = 'RegScore',
col = species.fctr)
# Regression coefficients ----
coef.headshape <- fit.headshape.sp$LM$coefficients
coef.limbshape <- fit.limbshape.sp$LM$coefficients
coef.head <- fit.head.sp$LM$coefficients
coef.limb <- fit.limb.sp$LM$coefficients
coef.shape <- fit.shape.sp$LM$coefficients
head.slp <- coef.head[grep('svl', rownames(coef.head)), ]
head.slp[-1] <- head.slp[-1] + head.slp[1]
names(head.slp) <- gsub('svl:species.fctr', '', names(head.slp))
names(head.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(head.slp))
limb.slp <- coef.limb[grep('svl', rownames(coef.limb)), ]
limb.slp[-1] <- limb.slp[-1] + limb.slp[1]
names(limb.slp) <- gsub('svl:species.fctr', '', names(limb.slp))
names(limb.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(limb.slp))
shape.slp <- coef.shape[grep('svl', rownames(coef.shape)), ]
shape.slp[-1] <- shape.slp[-1] + shape.slp[1]
names(shape.slp) <- gsub('svl:species.fctr', '', names(shape.slp))
names(shape.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(shape.slp))
coef.limbshape
coef.headshape[grep('svl', rownames(coef.headshape)), ]
# Per-species slopes ----
headshape.slp <- coef.headshape[grep('svl', rownames(coef.headshape)), ]
headshape.slp[-1] <- headshape.slp[-1] + headshape.slp[1]
names(headshape.slp) <- gsub('svl:species.fctr', '', names(headshape.slp))
names(headshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(headshape.slp))
headshape.slp
headshape.slp
# Per-species slopes ----
headshape.slp <- coef.headshape[grep('svl', rownames(coef.headshape)), ]
headshape.slp
headshape.slp[-1]
headshape.slp[1]
headshape.slp[-1,] + headshape.slp[1,]
headshape.slp
headshape.slp[-1,] <- headshape.slp[-1,] + headshape.slp[1,]
headshape.slp
names(headshape.slp) <- gsub('svl:species.fctr', '', names(headshape.slp))
names(headshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(headshape.slp))
head.slp
coef.head[grep('svl', rownames(coef.head)), ]
headshape.slp
# Per-species slopes ----
headshape.slp <- coef.headshape[grep('svl', rownames(coef.headshape)), ]
headshape.slp[-1,] <- headshape.slp[-1,] + headshape.slp[1,]
names(headshape.slp) <- gsub('svl:species.fctr', '', names(headshape.slp))
names(headshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', names(headshape.slp))
headshape.slp
# Per-species slopes ----
headshape.slp <- coef.headshape[grep('svl', rownames(coef.headshape)), ]
headshape.slp
headshape.slp[-1,] <- headshape.slp[-1,] + headshape.slp[1,]
headshape.slp
names(headshape.slp)
rownames(headshape.slp)
rownames(headshape.slp) <- gsub('svl:species.fctr', '', rownames(headshape.slp))
rownames(headshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', rownames(headshape.slp))
headshape.slp
limbshape.slp <- coef.limbshape[grep('svl', rownames(coef.limbshape)), ]
limbshape.slp[-1,] <- limbshape.slp[-1,] + limbshape.slp[1,]
rownames(limbshape.slp) <- gsub('svl:species.fctr', '', rownames(limbshape.slp))
rownames(limbshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', rownames(limbshape.slp))
limbshape.slp
# Compare evol and static allometry head and limbs per habitat ----
headshape.slp
limbshape.slp
slp.headshape.hab
slp.limbshape.hab
hab.mn
headshape.slp[hab.mn == 'ground', ]
slp.headshape.hab['ground',]
slp.headshape.ground <-rbind(evol_alom = slp.headshape.hab['ground',],
headshape.slp[hab.mn == 'ground', ])
slp.headshape.ground <-rbind(evol_alom = slp.headshape.hab['ground',],
headshape.slp[hab.mn == 'ground', ])
slp.headshape.correlations.ground <- vec.cor.matrix(slp.headshape.ground)[1,]
slp.headshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.headshape.ground))*180/pi)[1,]
slp.headshape.correlations.ground
slp.headshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.headshape.ground))*180/pi)[1,]
slp.headshape.angles.ground
slp.limbshape.ground <-rbind(evol_alom = slp.limbshape.hab['ground',],
limbshape.slp[hab.mn == 'ground', ])
slp.limbshape.hab
limbshape.slp[hab.mn == 'ground', ]
slp.limbshape.ground <-rbind(evol_alom = slp.limbshape.hab['ground',],
limbshape.slp[hab.mn == 'ground', ])
slp.headshape.ground <-rbind(evol_alom = slp.headshape.hab['ground',],
headshape.slp[hab.mn == 'ground', ])
slp.limbshape.ground <-rbind(evol_alom = slp.limbshape.hab['ground',],
limbshape.slp[hab.mn == 'ground', ])
slp.limbshape.ground
limbshape.slp
limbshape.slp <- coef.limbshape[grep('svl', rownames(coef.limbshape)), ]
limbshape.slp[-1,] <- limbshape.slp[-1,] + limbshape.slp[1,]
rownames(limbshape.slp) <- gsub('svl:species.fctr', '', rownames(limbshape.slp))
rownames(limbshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', rownames(limbshape.slp))
limbshape.slp
fit.limbshape.sp <- lm.rrpp(shape.limb ~ svl*species.fctr)
plot.limbshape.fit <- plot(fit.limbshape.sp, predictor = svl, type = 'regression', pch = 16,
col = species.fctr)
plot.limbshape.fit$PredLine
plot.limbshape.fit$RegScore
plot(fit.limbshape.sp, predictor = svl, type = 'regression', pch = 16,
reg.type = 'RegScore',
col = species.fctr)
# Regression coefficients ----
coef.headshape <- fit.headshape.sp$LM$coefficients
coef.limbshape <- fit.limbshape.sp$LM$coefficients
# Per-species slopes ----
headshape.slp <- coef.headshape[grep('svl', rownames(coef.headshape)), ]
headshape.slp[-1,] <- headshape.slp[-1,] + headshape.slp[1,]
rownames(headshape.slp) <- gsub('svl:species.fctr', '', rownames(headshape.slp))
rownames(headshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', rownames(headshape.slp))
limbshape.slp <- coef.limbshape[grep('svl', rownames(coef.limbshape)), ]
limbshape.slp[-1,] <- limbshape.slp[-1,] + limbshape.slp[1,]
rownames(limbshape.slp) <- gsub('svl:species.fctr', '', rownames(limbshape.slp))
rownames(limbshape.slp) <- gsub('svl', 'Pristurus_abdelkuri', rownames(limbshape.slp))
# Compare evol and static allometry head and limbs per habitat ----
headshape.slp
limbshape.slp
slp.headshape.hab
slp.limbshape.hab
slp.headshape.ground <-rbind(evol_alom = slp.headshape.hab['ground',],
headshape.slp[hab.mn == 'ground', ])
slp.headshape.correlations.ground <- vec.cor.matrix(slp.headshape.ground)[1,]
slp.headshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.headshape.ground))*180/pi)[1,]
slp.limbshape.ground <-rbind(evol_alom = slp.limbshape.hab['ground',],
limbshape.slp[hab.mn == 'ground', ])
slp.limbshape.correlations.ground <- vec.cor.matrix(slp.limbshape.ground)[1,]
slp.limbshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.limbshape.ground))*180/pi)[1,]
slp.limbshape.correlations.ground
slp.limbshape.angles.ground
# head ground
slp.headshape.ground <-rbind(evol_alom = slp.headshape.hab['ground',],
headshape.slp[hab.mn == 'ground', ])
slp.headshape.correlations.ground <- vec.cor.matrix(slp.headshape.ground)[1,]
slp.headshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.headshape.ground))*180/pi)[1,]
# head rock
slp.headshape.rock <-rbind(evol_alom = slp.headshape.hab['rock',],
headshape.slp[hab.mn == 'rock', ])
slp.headshape.correlations.rock <- vec.cor.matrix(slp.headshape.rock)[1,]
slp.headshape.angles.rock <- (acos(RRPP:::vec.cor.matrix(slp.headshape.rock))*180/pi)[1,]
# head tree
slp.headshape.tree <-rbind(evol_alom = slp.headshape.hab['tree',],
headshape.slp[hab.mn == 'tree', ])
slp.headshape.correlations.tree <- vec.cor.matrix(slp.headshape.tree)[1,]
slp.headshape.angles.tree <- (acos(RRPP:::vec.cor.matrix(slp.headshape.tree))*180/pi)[1,]
# limb ground
slp.limbshape.ground <-rbind(evol_alom = slp.limbshape.hab['ground',],
limbshape.slp[hab.mn == 'ground', ])
slp.limbshape.correlations.ground <- vec.cor.matrix(slp.limbshape.ground)[1,]
slp.limbshape.angles.ground <- (acos(RRPP:::vec.cor.matrix(slp.limbshape.ground))*180/pi)[1,]
# limb rock
slp.limbshape.rock <-rbind(evol_alom = slp.limbshape.hab['rock',],
limbshape.slp[hab.mn == 'rock', ])
slp.limbshape.correlations.rock <- vec.cor.matrix(slp.limbshape.rock)[1,]
slp.limbshape.angles.rock <- (acos(RRPP:::vec.cor.matrix(slp.limbshape.rock))*180/pi)[1,]
# limb tree
slp.limbshape.tree <-rbind(evol_alom = slp.limbshape.hab['tree',],
limbshape.slp[hab.mn == 'tree', ])
slp.limbshape.correlations.tree <- vec.cor.matrix(slp.limbshape.tree)[1,]
slp.limbshape.angles.tree <- (acos(RRPP:::vec.cor.matrix(slp.limbshape.tree))*180/pi)[1,]
slp.limbshape.angles.tree
slp.headshape.correlations.tree
slp.headshape.angles.tree
head_static_plot
fit.sp.ggplot.data
head.slp
pred_head
slp.headshape.angles.ground
slp.headshape.angles.rock
slp.headshape.angles.tree
slp.limbshape.angles.ground
slp.headshape.correlations.ground
slp.headshape.angles.ground
slp.headshape.correlations.ground
as.data.frame(slp.headshape.correlations.ground)
data.frame(cor = slp.headshape.correlations.ground,
angle = slp.headshape.angles.ground)
dd <- data.frame(cor = slp.headshape.correlations.ground,
angle = slp.headshape.angles.ground)
data.frame(cor = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle = slp.headshape.angles.ground)
c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree)
data.frame(cor = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree))
c(names(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree)
)
c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)
)
data.frame(species = c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)),
cor = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree))
length(slp.headshape.angles.ground)
data.frame(species = c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)),
hab = c(rep('ground', length(slp.headshape.angles.ground)),
rep('rock', length(slp.headshape.angles.rock)),
rep('tree', length(slp.headshape.angles.tree))),
cor = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree))
slp.limbshape.correlations.ground
data.frame(species = c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)),
hab = c(rep('ground', length(slp.headshape.angles.ground)),
rep('rock', length(slp.headshape.angles.rock)),
rep('tree', length(slp.headshape.angles.tree))),
cor_head = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle_head = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree),
cor_limb = c(slp.limbshape.correlations.ground,
slp.limbhape.correlations.rock,
slp.limbshape.correlations.tree),
angle_limb = c(slp.limbshape.angles.ground,
slp.limbshape.angles.rock,
slp.limbshape.angles.tree))
data.frame(species = c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)),
hab = c(rep('ground', length(slp.headshape.angles.ground)),
rep('rock', length(slp.headshape.angles.rock)),
rep('tree', length(slp.headshape.angles.tree))),
cor_head = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle_head = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree),
cor_limb = c(slp.limbshape.correlations.ground,
slp.limbshape.correlations.rock,
slp.limbshape.correlations.tree),
angle_limb = c(slp.limbshape.angles.ground,
slp.limbshape.angles.rock,
slp.limbshape.angles.tree))
cor.angle.table <- data.frame(species = c(names(slp.headshape.angles.ground),
names(slp.headshape.angles.rock),
names(slp.headshape.angles.tree)),
hab = c(rep('ground', length(slp.headshape.angles.ground)),
rep('rock', length(slp.headshape.angles.rock)),
rep('tree', length(slp.headshape.angles.tree))),
cor_head = c(slp.headshape.correlations.ground,
slp.headshape.correlations.rock,
slp.headshape.correlations.tree),
angle_head = c(slp.headshape.angles.ground,
slp.headshape.angles.rock,
slp.headshape.angles.tree),
cor_limb = c(slp.limbshape.correlations.ground,
slp.limbshape.correlations.rock,
slp.limbshape.correlations.tree),
angle_limb = c(slp.limbshape.angles.ground,
slp.limbshape.angles.rock,
slp.limbshape.angles.tree))
cor.angle.table[cor.angle.table$species != 'evol_alom', ]
cor.angle.table <- cor.angle.table[cor.angle.table$species != 'evol_alom', ]
cor.angle.table
write.table(cor.angle.table, '../Tables/cor_angles.csv', sep = ';',
dec = '.', quote = FALSE, row.names = FALSE)
pred_head
# PLOT STATIC ALLOMETRY PER HABITAT ----
fit.sp.ggplot.data <- data.frame(pred_head = plot.pls.head$PredLine,
regscore_head = plot.pls.head$RegScore,
slope_head = head.slp[rdf$species],
pred_limb = plot.pls.limb$PredLine,
regscore_limb = plot.pls.limb$RegScore,
slope_limb = limb.slp[rdf$species],
svl = rdf$svl,
habitat = rdf$habitat,
sp = rdf$species)
fit.sp.ggplot.data$slope_head
range(fit.sp.ggplot.data$slope_head)
slp.comp.ground
vec.cor.matrix(slp.comp.ground)
vec.cor.matrix(slp.comp.ground)
round(vec.cor.matrix(slp.comp.ground), 2)
dd <- round(vec.cor.matrix(slp.comp.ground), 2)
names(dd)
colnames(dd)
rownames(dd)
gsub('Pristurus_', 'P_', rownames(dd))
colnames(dd) <- rownames(dd) <- gsub('Pristurus_', 'P_', rownames(dd))
colnames(dd) <- rownames(dd) <- gsub('Pristurus_', 'P_', rownames(dd))
dd
dd
acos(RRPP:::vec.cor.matrix(dd))*180/pi
?diag
slp.hab
sp.slp
sp.slp
cor.angle.table
sp.slp
sp.slp[cor.angle.table$species,]
cor.angle.table$species
sp.slp[as.character(cor.angle.table$species),]
cor.angle.table
# COMPARE BETWEEN SPECIES ----
sp.slp[as.character(cor.angle.table$species),]
# COMPARE BETWEEN SPECIES ----
# Sort by habitat
slp.sort <- sp.slp[as.character(cor.angle.table$species),]
# Get correlation matrix between species
round(vec.cor.matrix(slp.sort), 2)
slp.sort
acos(RRPP:::vec.cor.matrix(slp.sort))*180/pi
acos(RRPP:::vec.cor.matrix(slp.sp.cor))*180/pi
# Get correlation matrix between species
slp.sp.cor <- round(vec.cor.matrix(slp.sort), 2)
acos(RRPP:::vec.cor.matrix(slp.sp.cor))*180/pi
slp.sp.angle <- acos(RRPP:::vec.cor.matrix(slp.sort))*180/pi
slp.comp.ground
acos(RRPP:::vec.cor.matrix(slp.comp.ground))*180/pi
slp.sp.cor
slp.sp.angle
View(slp.sp.angle)
write.table(slp.sp.angle, '../Tables/angles_between_species_slopes.csv', sep = ';',
dec = '.', quote = FALSE, row.names = FALSE)
cor.angle.table <- round(cor.angle.table[cor.angle.table$species != 'evol_alom', ], 2)
cor.angle.table
slp.sp.angle <- round(acos(RRPP:::vec.cor.matrix(slp.sort))*180/pi, 2)
write.table(slp.sp.angle, '../Tables/angles_between_species_slopes.csv', sep = ';',
dec = '.', quote = FALSE, row.names = FALSE)
heatmap(slp.sp.angle)
heatmap.2(slp.sp.angle)
heatmap(slp.sp.angle, Rowv = FALSE)
